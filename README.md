# Gatsby —Å–∞–π—Ç —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ–º –≤ Yandex Cloud

–≠—Ç–æ—Ç —à–∞–±–ª–æ–Ω –ø–æ–∑–≤–æ–ª—è–µ—Ç –±—ã—Å—Ç—Ä–æ —Å–æ–∑–¥–∞—Ç—å Gatsby —Å–∞–π—Ç —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ–º –≤ Yandex Cloud —á–µ—Ä–µ–∑ SourceCraft CI/CD.

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è "–°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–∞–π—Ç"

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç –≤—Å—é –Ω–µ–æ–±—Ö–æ–¥–∏–º—É—é –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É:

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ [—Å—Ç—Ä–∞–Ω–∏—Ü—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è](https://yandex.cloud/ru/marketplace/products/yc/static-site)

2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, —É–∫–∞–∂–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:
   - **–ò–º—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è**: –Ω–∞–ø—Ä–∏–º–µ—Ä, `my-gatsby-site`
   - **–°–µ—Ä–≤–∏—Å–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç**: —Å–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –∏–ª–∏ –≤—ã–±–µ—Ä–∏—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Å —Ä–æ–ª—è–º–∏ `storage.admin`, `lockbox.admin`, `certificate-manager.admin`, `dns.admin` (`admin` –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –≤—Å–µ —ç—Ç–∏ —Ä–æ–ª–∏)
   - **DNS –∑–æ–Ω–∞**: –≤—ã–±–µ—Ä–∏—Ç–µ DNS –∑–æ–Ω—É –¥–ª—è –≤–∞—à–µ–≥–æ –¥–æ–º–µ–Ω–∞
   - **–ü–æ–¥–¥–æ–º–µ–Ω** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ): –µ—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω, —Å–∞–π—Ç –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ –∫–æ—Ä–Ω–µ–≤–æ–º –¥–æ–º–µ–Ω–µ
   - **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è**: –≤—ã–±–µ—Ä–∏—Ç–µ **Gatsby**

3. –ù–∞–∂–º–∏—Ç–µ **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å** –∏ –¥–æ–∂–¥–∏—Ç–µ—Å—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ \
   **–í–∞–∂–Ω–æ!** –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –º–æ–∂–µ—Ç –≤—ã–ø–∏—Å—ã–≤–∞—Ç—å—Å—è –¥–æ 15 –º–∏–Ω—É—Ç.

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ "–°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–∞–π—Ç" –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç:
- ‚úÖ **S3 bucket** –¥–ª—è —Ö–æ—Å—Ç–∏–Ω–≥–∞ —Å–∞–π—Ç–∞
- ‚úÖ **SSL-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç** –æ—Ç Let's Encrypt —Å –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º
- ‚úÖ **DNS –∑–∞–ø–∏—Å–∏** –¥–ª—è –≤–∞—à–µ–≥–æ –¥–æ–º–µ–Ω–∞
- ‚úÖ **–°–µ–∫—Ä–µ—Ç—ã –≤ Lockbox** —Å –∫–ª—é—á–∞–º–∏ –¥–æ—Å—Ç—É–ø–∞ –∫ S3

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

–ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ —ç—Ç–æ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:

#### 2.1. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Å–µ—Ä–≤–∏—Å–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ (–µ—Å–ª–∏ —É –≤–∞—Å –µ–≥–æ –ø–æ–∫–∞ –Ω–µ—Ç)

1. –í SourceCraft —Å–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤–æ–µ —Å–µ—Ä–≤–∏—Å–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
2. –£–∫–∞–∂–∏—Ç–µ —Å–µ—Ä–≤–∏—Å–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç, —Å–æ–∑–¥–∞–Ω–Ω—ã–π –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–ª–∏–±–æ –ª—é–±–æ–π –¥—Ä—É–≥–æ–π —Å –ø—Ä–∞–≤–∞–º–∏ `lockbox.viewer`, `lockbox.payloadViewer`)
3. –ó–∞–ø–æ–º–Ω–∏—Ç–µ –∏–º—è —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è, –µ–≥–æ –Ω–∞–¥–æ –±—É–¥–µ—Ç —É–∫–∞–∑–∞—Ç—å –≤ —Ñ–∞–π–ª–µ `.sourcecraft/ci.yaml`

#### 2.2. –û–±–Ω–æ–≤–∏—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

**–í —Ñ–∞–π–ª–µ [`gatsby-config.ts`](gatsby-config.ts):**
```typescript
const config: GatsbyConfig = {
  siteMetadata: {
    title: `<<YOUR_SITE_TITLE>>`,           // –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –Ω–∞–∑–≤–∞–Ω–∏–µ —Å–∞–π—Ç–∞
    siteUrl: `https://<<YOUR_DOMAIN_NAME>>`, // –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à –¥–æ–º–µ–Ω
  },
  // ...
  plugins: [
    {
      resolve: `gatsby-plugin-s3`,
      options: {
        bucketName: "<<YOUR_DOMAIN_NAME>>", // –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à –¥–æ–º–µ–Ω
        region: "ru-central1",
        protocol: "https",
        hostname: "storage.yandexcloud.net",
        customAwsEndpointHostname: 'storage.yandexcloud.net'
      },
    }
  ],
}
```

**–í —Ñ–∞–π–ª–µ [`.sourcecraft/ci.yaml`](.sourcecraft/ci.yaml):**
```yaml
tokens:
  SERVICE_CONNECTION:
    service_connection: default-service-connection  # –ò–º—è —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

workflows:
  gatsby-deploy:
    env:
      DOMAIN_NAME: <<YOUR_DOMAIN_NAME>>  # –í–∞—à –¥–æ–º–µ–Ω
```

### 3. –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ñ–∞–π–ª–æ–≤:

1. –°–¥–µ–ª–∞–π—Ç–µ commit –∏ push –≤ –≤–µ—Ç–∫—É `main`
2. SourceCraft –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å—Ç–∏—Ç CI/CD –ø–∞–π–ø–ª–∞–π–Ω
3. –°–∞–π—Ç –±—É–¥–µ—Ç —Å–æ–±—Ä–∞–Ω –∏ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç –≤ S3
4. –°–∞–π—Ç —Å—Ç–∞–Ω–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É `https://–≤–∞—à-–¥–æ–º–µ–Ω`

## üöÄ Gatsby

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç [Gatsby](https://www.gatsbyjs.com/) - —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –±—ã—Å—Ç—Ä—ã—Ö —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Å–∞–π—Ç–æ–≤ –Ω–∞ React. Gatsby –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –æ—Ç–ª–∏—á–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–ø—ã—Ç.

### –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:
- ‚ö° –ë—ã—Å—Ç—Ä–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü
- üîç SEO-–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏–∑ –∫–æ—Ä–æ–±–∫–∏
- üì± –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- üé® –ü–æ–¥–¥–µ—Ä–∂–∫–∞ TypeScript
- üîß –ë–æ–≥–∞—Ç–∞—è —ç–∫–æ—Å–∏—Å—Ç–µ–º–∞ –ø–ª–∞–≥–∏–Ω–æ–≤

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
‚îú‚îÄ‚îÄ .sourcecraft/
‚îÇ   ‚îî‚îÄ‚îÄ ci.yaml              # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è CI/CD
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ images/              # –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ pages/               # –°—Ç—Ä–∞–Ω–∏—Ü—ã —Å–∞–π—Ç–∞
‚îÇ       ‚îú‚îÄ‚îÄ index.tsx        # –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
‚îÇ       ‚îî‚îÄ‚îÄ 404.tsx          # –°—Ç—Ä–∞–Ω–∏—Ü–∞ 404
‚îú‚îÄ‚îÄ gatsby-config.ts         # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Gatsby
‚îú‚îÄ‚îÄ package.json             # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Node.js
‚îú‚îÄ‚îÄ tsconfig.json            # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è TypeScript
‚îî‚îÄ‚îÄ README.md                # –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

## üõ†Ô∏è –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞

–î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
npm install

# –ó–∞–ø—É—Å–∫ dev-—Å–µ—Ä–≤–µ—Ä–∞
npm run develop

# –°–±–æ—Ä–∫–∞ –¥–ª—è production
npm run build

# –õ–æ–∫–∞–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä production —Å–±–æ—Ä–∫–∏
npm run serve
```

–°–∞–π—Ç –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É `http://localhost:8000`

## üîç –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

### –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ SSL-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞

SSL-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –º–æ–∂–µ—Ç –≤—ã–ø–∏—Å—ã–≤–∞—Ç—å—Å—è –¥–æ 10-15 –º–∏–Ω—É—Ç. –û—Ç—Å–ª–µ–¥–∏—Ç—å —Å—Ç–∞—Ç—É—Å –º–æ–∂–Ω–æ:

1. –í –∫–æ–Ω—Å–æ–ª–∏ Yandex Cloud –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Cloud Apps**
2. –ù–∞–π–¥–∏—Ç–µ –≤–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ "–°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–∞–π—Ç"
3. –í —Ä–∞–∑–¥–µ–ª–µ **–†–µ—Å—É—Ä—Å—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è** –Ω–∞–π–¥–∏—Ç–µ —Ä–µ—Å—É—Ä—Å —Ç–∏–ø–∞ `certificate`
4. –î–æ–∂–¥–∏—Ç–µ—Å—å —Å—Ç–∞—Ç—É—Å–∞ "–í—ã–¥–∞–Ω"

### –õ–æ–≥–∏ CI/CD

–í SourceCraft –≤—ã –º–æ–∂–µ—Ç–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è:

- üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Yandex Cloud CLI
- üîç –ü–æ–∏—Å–∫ —Å–µ–∫—Ä–µ—Ç–æ–≤ –≤ Lockbox
- üîë –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–ª—é—á–µ–π –¥–æ—Å—Ç—É–ø–∞ –∫ S3
- üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π Node.js
- üèóÔ∏è –°–±–æ—Ä–∫–∞ Gatsby —Å–∞–π—Ç–∞
- üöÄ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –≤ production

## üìö –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Gatsby](https://www.gatsbyjs.com/docs/)
- [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è SourceCraft](https://sourcecraft.dev/portal/docs/ru/)
- [Yandex Object Storage](https://yandex.cloud/ru/services/storage)
- [gatsby-plugin-s3](https://github.com/jariz/gatsby-plugin-s3)

## ü§ù –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ —É –≤–∞—Å –≤–æ–∑–Ω–∏–∫–ª–∏ –≤–æ–ø—Ä–æ—Å—ã:

- **–ü–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é "–°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–∞–π—Ç"**: –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –≤ [—Ç–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫—É Yandex Cloud](https://console.cloud.yandex.ru/support)
- **–ü–æ Gatsby**: –∏–∑—É—á–∏—Ç–µ [–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é](https://www.gatsbyjs.com/docs/)
- **–ü–æ SourceCraft**: –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É SourceCraft
